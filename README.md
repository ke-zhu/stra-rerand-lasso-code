# Lasso Adjustment in Stratified and Rerandomized Experiments

This repository contains the code accompanying our paper:

Zhu, K., Liu, H., & Yang, Y. (2024). [Design-based theory for lasso adjustment in randomized block experiments and rerandomized experiments.](https://www.tandfonline.com/doi/full/10.1080/07350015.2024.2403381) *Journal of Business & Economic Statistics*, in press. [[Paper]](https://drive.google.com/file/d/1CG2LFFoNklAKZGLoSOexTEjpcvv6VI_c/view?usp=share_link) [[Slides]](https://drive.google.com/file/d/1U_IFeQeBr02D8ypQrqGq7UoJ7Ffw8huE/view?usp=share_link)

---
## Structure in `code/`

- `data/`: Contains real datasets and stores simulated data generated by scripts  
  - **OK Data** from [Angrist Data Archive](https://economics.mit.edu/people/faculty/josh-angrist/angrist-data-archive)  
  - **Fish Data** from [NHANES](https://www.cdc.gov/nchs/nhanes/index.html)

- `output/`: Stores outputs from both simulations and real-data analyses

- `chart/`: Scripts for generating plots based on results in `output/`

- `stra.R`, `utility.R`: Core function files used throughout simulations and applications

- `1_data_main.R` to `4_real_data.R`: Scripts for producing numerical results presented in the main text

- `S1_*.R` to `S8_*.R`: Scripts for producing numerical results in the supplementary materials


---

## Citation

If you use this code or refer to our methodology, please cite:

```bibtex
@article{zhu2024design,
  title={Design-Based Theory for Lasso Adjustment in Randomized Block Experiments and Rerandomized Experiments},
  author={Zhu, Ke and Liu, Hanzhong and Yang, Yuehan},
  journal={Journal of Business \& Economic Statistics},
  year={2024},
  doi={10.1080/07350015.2024.2403381}
}
```
